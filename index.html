<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ë²”ìš© ì•½ë¬¼ ìš©ëŸ‰ ê³„ì‚°ê¸°</title>
  <style>
    :root{ --blue:#003399; --bg:#f9fafb; --card:#fff; --border:#e5e7eb; --muted:#6b7280; --ink:#111827; --accent:#fbbf24 }
    *{box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;background:var(--bg);color:var(--ink);padding:24px}
    h2{margin:0 0 16px;font-size:1.45rem;color:var(--blue);text-align:center;display:flex;align-items:center;justify-content:center;gap:8px}
    h2 span.icon{font-size:1.5rem;color:var(--accent)}

    /* Tabs */
    .tabs{display:flex;justify-content:center;gap:10px;margin:0 auto 16px;flex-wrap:wrap}
    .tab-btn{padding:10px 16px;border:1px solid var(--border);background:#fff;border-radius:10px;cursor:pointer;font-weight:600;color:#374151;transition:all .2s}
    .tab-btn:hover{background:#f3f4f6}
    .tab-btn[aria-selected="true"]{background:var(--blue);color:#fff;border-color:var(--blue);box-shadow:0 2px 6px rgba(29,78,216,.25)}
    .subnote{margin:-4px 0 14px;text-align:center;color:var(--muted);font-size:.85rem}

    /* Cards */
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;max-width:580px;margin:0 auto;box-shadow:0 3px 8px rgba(0,0,0,.06);transition:transform .2s}
    .card:hover{transform:translateY(-2px)}
    .row{display:flex;flex-direction:column;gap:14px}
    label{font-size:.92rem;font-weight:600;margin-bottom:4px;color:#1e40af}
    input, select{padding:9px;font-size:1rem;border:1px solid var(--border);border-radius:10px;text-align:center;background:#fff;transition:border .2s}
    input:focus, select:focus{border-color:var(--blue);outline:none;box-shadow:0 0 0 2px rgba(37,99,235,.2)}
    .inline{display:flex;gap:8px;align-items:center}
    .unitBox{min-width:68px;text-align:center;font-weight:700;color:#374151}
    .result{margin-top:12px;font-size:1.08rem;font-weight:700;color:#1e3a8a;text-align:center;line-height:1.5;padding:10px;border-radius:10px;background:#f1f5f9}

    .tabpanel{display:none}
    .tabpanel.show{display:block}
  </style>
</head>
<body>
  <h2><span class="icon">ğŸ’Š</span> ë²”ìš© ì•½ë¬¼ ìš©ëŸ‰ ê³„ì‚°ê¸°</h2>
  <div class="tabs" role="tablist" aria-label="ì œí˜• ì„ íƒ">
    <button id="tab-liquid" class="tab-btn" role="tab" aria-selected="true" aria-controls="panel-liquid">ì•¡ìƒ ì œí˜• (ì£¼ì‚¬/ìš©ì•¡)</button>
    <button id="tab-tablet" class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-tablet">ì •ì œÂ·ìº¡ìŠ (ê²½êµ¬)</button>
  </div>
  <div class="subnote">ì›í•˜ëŠ” ì œí˜• íƒ­ì„ ì„ íƒí•˜ë©´ í•´ë‹¹ ê³„ì‚°ê¸°ë§Œ í‘œì‹œë©ë‹ˆë‹¤.</div>

  <!-- ì•¡ìƒ ì œí˜• íƒ­íŒ¨ë„ -->
  <section id="panel-liquid" class="tabpanel show" role="tabpanel" aria-labelledby="tab-liquid">
    <div class="card">
      <div class="row">
        <div>
          <label for="drug">ì•½ë¬¼ ì´ë¦„</label>
          <input type="text" id="drug">
        </div>
        <div>
          <label for="weight">ì²´ì¤‘ (kg)</label>
          <input type="number" id="weight" placeholder="í•„ìˆ˜ì…ë ¥" min="0.1" step="0.1">
        </div>
        <div>
          <label for="conc">ì•½ë¬¼ ë†ë„</label>
          <div class="inline">
            <input type="number" id="conc" placeholder="í•„ìˆ˜ì…ë ¥" step="0.01">
            <select id="concUnit">
              <option value="mg">mg/mL</option>
              <option value="Âµg">Âµg/mL</option>
              <option value="g">g/mL</option>
            </select>
          </div>
        </div>
        <div>
          <label for="dose">íˆ¬ì—¬ëŸ‰</label>
          <div class="inline">
            <input type="number" id="dose" placeholder="í•„ìˆ˜ì…ë ¥" step="0.01">
            <select id="doseMassUnit">
              <option value="mgkg" selected>mg/kg</option>
              <option value="Âµgkg">Âµg/kg</option>
              <option value="gkg">g/kg</option>
            </select>
          </div>
        </div>
        <div class="result" id="result">ìš©ëŸ‰(Volume): - mL</div>
      </div>
    </div>
  </section>

  <!-- ì •ì œ/ìº¡ìŠ íƒ­íŒ¨ë„ -->
  <section id="panel-tablet" class="tabpanel" role="tabpanel" aria-labelledby="tab-tablet">
    <div class="card">
      <div class="row">
        <div>
          <label for="tdrug">ì•½ë¬¼ ì´ë¦„</label>
          <input type="text" id="tdrug">
        </div>
        <div>
          <label for="tweight">ì²´ì¤‘ (kg)</label>
          <input type="number" id="tweight" placeholder="í•„ìˆ˜ì…ë ¥" min="0.1" step="0.1">
        </div>
        <div>
          <label for="tdose">íˆ¬ì—¬ëŸ‰</label>
          <div class="inline">
            <input type="number" id="tdose" placeholder="í•„ìˆ˜ì…ë ¥" step="0.1">
            <select id="tdoseUnit">
              <option value="mgkg" selected>mg/kg</option>
              <option value="Âµgkg">Âµg/kg</option>
              <option value="gkg">g/kg</option>
              <option value="mgcat">mg/cat</option>
            </select>
          </div>
        </div>
        <div>
          <label for="tablet">ì •ì œ 1ê°œ í•¨ëŸ‰</label>
          <div class="inline">
            <input type="number" id="tablet" placeholder="í•„ìˆ˜ì…ë ¥" step="1">
            <select id="tabletUnit">
              <option value="mg" selected>mg</option>
              <option value="Âµg">Âµg</option>
              <option value="g">g</option>
            </select>
          </div>
        </div>
        <div>
          <label for="freq">ë³µìš©ë²•</label>
          <select id="freq">
            <option value="1">SID (1ì¼ 1íšŒ)</option>
            <option value="2">BID (1ì¼ 2íšŒ)</option>
            <option value="3">TID (1ì¼ 3íšŒ)</option>
            <option value="0.5">EOD (2ì¼ 1íšŒ(ê²©ì¼))</option>
          </select>
        </div>
        <div>
          <label for="days">íˆ¬ì—¬ ì¼ìˆ˜</label>
          <input type="number" id="days" value="7" min="1" step="1">
        </div>
        <div class="result" id="tresult">1íšŒ ë³µìš©ëŸ‰: - ê°œ<br>ì „ì²´ í•„ìš”ëŸ‰: - ê°œ</div>
      </div>
    </div>
  </section>

  <script>
    const unitFactorMg = { g: 1000, mg: 1, 'Âµg': 0.001 };

    // --- Tabs ---
    function showTab(which){
      const map = { liquid:['tab-liquid','panel-liquid'], tablet:['tab-tablet','panel-tablet'] };
      Object.entries(map).forEach(([k,[btnId,panelId]])=>{
        const btn = document.getElementById(btnId);
        const panel = document.getElementById(panelId);
        const active = (k===which);
        btn.setAttribute('aria-selected', active);
        panel.classList.toggle('show', active);
      });
      setTimeout(()=>{
        const first = which==='liquid' ? document.getElementById('drug') : document.getElementById('tdrug');
        first?.focus();
      }, 0);
    }
    document.getElementById('tab-liquid').addEventListener('click', ()=>showTab('liquid'));
    document.getElementById('tab-tablet').addEventListener('click', ()=>showTab('tablet'));

    // --- ì•¡ìƒ ê³„ì‚°ê¸° ---
    function calc(){
      const w = parseFloat(document.getElementById('weight').value);
      const conc = parseFloat(document.getElementById('conc').value);
      const concUnit = document.getElementById('concUnit').value;
      const dose = parseFloat(document.getElementById('dose').value);
      const doseMassUnit = document.getElementById('doseMassUnit').value;

      let vol = '-';
      if(!isNaN(w) && !isNaN(conc) && conc>0 && !isNaN(dose)){
        let totalDose_mg = 0;
        if(doseMassUnit.endsWith('kg')){
          const conc_mg_per_mL = conc * unitFactorMg[concUnit];
          const baseUnit = doseMassUnit.replace('kg','');
          const dose_mg_per_kg = dose * unitFactorMg[baseUnit];
          totalDose_mg = dose_mg_per_kg * w;
          vol = (totalDose_mg / conc_mg_per_mL).toFixed(2);
        } else if(doseMassUnit==='mgcat') {
          totalDose_mg = dose; // already mg per cat
          const conc_mg_per_mL = conc * unitFactorMg[concUnit];
          vol = (totalDose_mg / conc_mg_per_mL).toFixed(2);
        }
      }
      document.getElementById('result').textContent = `ìš©ëŸ‰(Volume): ${vol} mL`;
    }

    // --- ì •ì œ ê³„ì‚°ê¸° ---
    function calcTablet(){
      const w = parseFloat(document.getElementById('tweight').value);
      const dose = parseFloat(document.getElementById('tdose').value);
      const doseUnit = document.getElementById('tdoseUnit').value;
      const tablet = parseFloat(document.getElementById('tablet').value);
      const tabletUnit = document.getElementById('tabletUnit').value || 'mg';
      const freq = parseFloat(document.getElementById('freq').value);
      const days = parseInt(document.getElementById('days').value);

      let res1 = '-', res2 = '-';
      if(!isNaN(dose) && !isNaN(tablet) && tablet>0){
        let perDose_mg = 0;
        if(doseUnit.endsWith('kg')){
          const baseUnit = doseUnit.replace('kg','');
          const dose_mg_per_kg = dose * unitFactorMg[baseUnit];
          perDose_mg = dose_mg_per_kg * w;
        } else if(doseUnit==='mgcat'){
          perDose_mg = dose;
        }
        const tablet_mg = tablet * unitFactorMg[tabletUnit];
        const nTabletsPerDose = perDose_mg / tablet_mg;
        res1 = `${nTabletsPerDose.toFixed(2)} ê°œ`;
        if(!isNaN(freq) && !isNaN(days)){
          let totalDoses = (freq === 0.5) ? Math.ceil(days/2) : freq * days;
          const totalTablets = nTabletsPerDose * totalDoses;
          res2 = `${totalTablets.toFixed(2)} ê°œ`;
        }
      }
      document.getElementById('tresult').innerHTML = `1íšŒ ë³µìš©ëŸ‰: ${res1}<br>ì „ì²´ í•„ìš”ëŸ‰: ${res2}`;
    }

    // ì´ë²¤íŠ¸ ë°”ì¸ë”©
    document.querySelectorAll('#drug, #weight, #conc, #concUnit, #dose, #doseMassUnit').forEach(el=>{
      el.addEventListener('input', calc);
      el.addEventListener('change', calc);
    });
    document.querySelectorAll('#tdrug, #tweight, #tdose, #tdoseUnit, #tablet, #tabletUnit, #freq, #days').forEach(el=>{
      el.addEventListener('input', calcTablet);
      el.addEventListener('change', calcTablet);
    });

    calc();
    calcTablet();
    showTab('liquid');
  </script>
</body>
</html>
